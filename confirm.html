<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>入力確認</title>
<style>
  body{margin:0;font-family:system-ui,-apple-system,sans-serif;background:#fff;color:#000}
  .wrap{max-width:480px;margin:0 auto;padding:16px}
  .card{border:2px solid #000;padding:12px;margin-bottom:12px}
  .row{display:flex;justify-content:space-between;margin:4px 0}
  .label{font-weight:900}
  .note{margin-top:6px;font-size:14px}
  .actions{display:flex;justify-content:flex-end;gap:8px;margin-top:10px}
  .actionBtn{border:2px solid #000;background:#fff;padding:6px 10px;font-weight:900;font-size:14px}
  /* ---- TSMS Hamburger Menu (overlay) ---- */
.tsms-header{
  position:sticky; top:0; z-index:100;
  height:60px; background:#fff;
  border-bottom:2px solid #000;
  display:flex; align-items:center;
  padding:0 14px 0 56px;
  font-weight:900; font-size:20px;
}
.tsms-hamburger{
  position:absolute; left:14px; top:50%;
  transform:translateY(-50%);
  width:32px; height:24px;
  display:flex; flex-direction:column; justify-content:space-between;
  cursor:pointer; user-select:none;
}
.tsms-hamburger span{ height:3px; background:#000; display:block; }
.tsms-menu{
  position:fixed; top:0; left:0; height:100%; width:280px;
  background:#fff; border-right:2px solid #000;
  transform:translateX(-100%);
  transition:transform .25s ease;
  z-index:1000; padding-top:60px;
}
.tsms-menu.open{ transform:translateX(0); }
.tsms-menu a{
  display:block; padding:16px;
  border-bottom:1px solid #ddd;
  text-decoration:none; color:#000;
  font-size:18px; font-weight:900;
}
.tsms-menu-bg{
  position:fixed; inset:0;
  background:rgba(0,0,0,.25);
  opacity:0; pointer-events:none;
  transition:opacity .2s ease;
  z-index:900;
}
.tsms-menu-bg.show{ opacity:1; pointer-events:auto; }
.tsms-build{ font-size:12px; color:#666; padding:8px 12px; }
/* -------------------------------------- */
/* ---- TSMS Hamburger Menu (overlay) ---- */
.tsms-header{
  position:sticky; top:0; z-index:100;
  height:60px; background:#fff;
  border-bottom:2px solid #000;
  display:flex; align-items:center;
  padding:0 14px 0 56px;
  font-weight:900; font-size:20px;
}
.tsms-hamburger{
  position:absolute; left:14px; top:50%;
  transform:translateY(-50%);
  width:32px; height:24px;
  display:flex; flex-direction:column; justify-content:space-between;
  cursor:pointer; user-select:none;
}
.tsms-hamburger span{ height:3px; background:#000; display:block; }
.tsms-menu{
  position:fixed; top:0; left:0; height:100%; width:280px;
  background:#fff; border-right:2px solid #000;
  transform:translateX(-100%);
  transition:transform .25s ease;
  z-index:1000; padding-top:60px;
}
.tsms-menu.open{ transform:translateX(0); }
.tsms-menu a{
  display:block; padding:16px;
  border-bottom:1px solid #ddd;
  text-decoration:none; color:#000;
  font-size:18px; font-weight:900;
}
.tsms-menu-bg{
  position:fixed; inset:0;
  background:rgba(0,0,0,.25);
  opacity:0; pointer-events:none;
  transition:opacity .2s ease;
  z-index:900;
}
.tsms-menu-bg.show{ opacity:1; pointer-events:auto; }
.tsms-build{ font-size:12px; color:#666; padding:8px 12px; }
/* -------------------------------------- */
</style>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="TSMS">

</head>
<body>
<div class="wrap">
<nav class="tsms-menu" id="tsmsMenu" aria-label="サイドメニュー">
  <a href="index.html">TOP</a>
  <a href="report.html">日報入力</a>
  <a href="confirm.html">入力確認</a>
  <a href="detail.html">詳細確認</a>
  <a href="ops.html">出庫/帰庫/休憩</a>
  <a href="sales.html">売上</a>
  <a href="settings.html">設定</a>
</nav>
<div class="tsms-menu-bg" id="tsmsMenuBg" aria-hidden="true"></div>
<header class="tsms-header">
  <div class="tsms-hamburger" id="tsmsHamburger" role="button" tabindex="0" aria-label="メニュー">
    <span></span><span></span><span></span>
  </div>
  入力確認
</header>
<div class="tsms-build"></div>

<div class="tsms-topbar">
  <button type="button" class="tsms-hamburger" id="tsmsHamburger" aria-label="メニュー">≡</button>
  <div style="font-weight:900;font-size:18px">入力確認</div>
</div>
<div class="tsms-menuBg" id="tsmsMenuBg"></div>
<nav class="tsms-menu" id="tsmsMenu" aria-label="サイドメニュー">
  <a href="index.html">TOP</a>
  <a href="report.html">日報入力</a>
  <a href="confirm.html">入力確認</a>
  <a href="detail.html">詳細確認</a>
  <a href="ops.html">出庫/帰庫/休憩</a>
  <a href="sales.html">売上</a>
  <a href="settings.html">設定</a>
</nav>

<div id="cards"></div>
</div>

<script>
/* Confirm minimal (file:// OK) : render + delete confirm + edit navigate */
(function(){
  let data = [{"time": "10:00", "rideType": "GO", "payMethod": "GO Pay", "cash": "", "credit": "2500", "note": "GOからの予約でした。"}, {"time": "10:05", "rideType": "無線", "payMethod": "現金", "cash": "1800", "credit": "", "note": "駅前待機からの配車"}, {"time": "10:12", "rideType": "GO", "payMethod": "乗込GO Pay", "cash": "", "credit": "3200", "note": "観光客利用"}, {"time": "10:18", "rideType": "チケット", "payMethod": "チケット他", "cash": "1200", "credit": "4100", "note": "法人契約分（現収＋未収）"}, {"time": "10:26", "rideType": "GO", "payMethod": "GO Pay", "cash": "", "credit": "1500", "note": "短距離移動"}, {"time": "10:33", "rideType": "無線", "payMethod": "カード", "cash": "", "credit": "2700", "note": "ホテル配車"}, {"time": "10:41", "rideType": "GO", "payMethod": "GO Pay", "cash": "", "credit": "3600", "note": "深夜帯利用"}, {"time": "10:55", "rideType": "チケット", "payMethod": "チケット他", "cash": "800", "credit": "5200", "note": "空港送迎（現収＋未収）"}, {"time": "11:03", "rideType": "GO", "payMethod": "乗込GO Pay", "cash": "", "credit": "2900", "note": "雨天時利用"}, {"time": "11:10", "rideType": "無線", "payMethod": "現金", "cash": "2100", "credit": "", "note": "常連様"}];

  function yen(v){
    const n = String(v||"").replace(/[^\d]/g,"");
    return n ? Number(n).toLocaleString("ja-JP")+"円" : "0円";
  }
  function esc(s){
    return String(s||"")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#39;");
  }
  function encodeRecord(rec){
    // pass record via querystring (no storage)
    const json = JSON.stringify(rec);
    return encodeURIComponent(btoa(unescape(encodeURIComponent(json))));
  }

  function render(){
    const root = document.getElementById("cards");
    if(!root) return;
    root.innerHTML = "";
    data.forEach((r, idx)=>{
      const card = document.createElement("div");
      card.className = "card";
      const rows = [];
      rows.push(`<div class="row"><span class="label">時間</span><span>${esc(r.time||"")}</span></div>`);
      rows.push(`<div class="row"><span class="label">乗車種別</span><span>${esc(r.rideType||"")}</span></div>`);
      rows.push(`<div class="row"><span class="label">支払い方法</span><span>${esc(r.payMethod||"")}</span></div>`);
      if(r.cash) rows.push(`<div class="row"><span class="label">現収</span><span>${esc(yen(r.cash))}</span></div>`);
      if(r.credit) rows.push(`<div class="row"><span class="label">未収</span><span>${esc(yen(r.credit))}</span></div>`);
      if(r.note) rows.push(`<div class="note">${esc(r.note)}</div>`);

      card.innerHTML = rows.join("\n") + `
        <div class="actions">
          <button type="button" class="actionBtn" data-action="edit" data-idx="${idx}">修正</button>
          <button type="button" class="actionBtn" data-action="delete" data-idx="${idx}">削除</button>
        </div>`;
      root.appendChild(card);
    });
  }

  document.addEventListener("click", (e)=>{
    const btn = e.target.closest("button.actionBtn");
    if(!btn) return;
    const action = btn.dataset.action;
    const idx = Number(btn.dataset.idx);
    if(Number.isNaN(idx) || !data[idx]) return;

    if(action === "delete"){
      const ok = confirm("削除してよろしいですか？\n\nいいえ = キャンセル\nはい = OK");
      if(!ok) return;
      data.splice(idx, 1);
      render();
      return;
    }

    if(action === "edit"){
      // report側が対応していれば、同じデータを表示できる
      const q = encodeRecord(data[idx]);
      location.href = "report.html?edit=1&data=" + q;
      return;
    }
  }, true);

  render();
})();
</script>

<script>
/* Hamburger (same ids) */
(function(){
  const btn = document.getElementById("tsmsHamburger");
  const bg  = document.getElementById("tsmsMenuBg");
  const menu= document.getElementById("tsmsMenu");
  if(!btn || !bg || !menu) return;

  function open(){ bg.classList.add("is-open"); menu.classList.add("is-open"); }
  function close(){ bg.classList.remove("is-open"); menu.classList.remove("is-open"); }

  btn.addEventListener("click", ()=>{
    if(menu.classList.contains("is-open")) close(); else open();
  });
  bg.addEventListener("click", close);
})();
</script>

<script>
(function(){
  const menu = document.getElementById("tsmsMenu");
  const bg = document.getElementById("tsmsMenuBg");
  const burger = document.getElementById("tsmsHamburger");
  if(!menu || !bg || !burger) return;

  function openMenu(){ menu.classList.add("open"); bg.classList.add("show"); }
  function closeMenu(){ menu.classList.remove("open"); bg.classList.remove("show"); }

  burger.addEventListener("click", openMenu);
  burger.addEventListener("keydown", (e)=>{ if(e.key==="Enter"||e.key===" ") openMenu(); });
  bg.addEventListener("click", closeMenu);
  menu.querySelectorAll("a").forEach(a=>a.addEventListener("click", closeMenu));
})();
</script>

  <script>
    (function(){if('serviceWorker'in navigator&&location.protocol.indexOf('http')===0){window.addEventListener('load',function(){navigator.serviceWorker.register('./sw.js').catch(function(){});});}})();
  </script>

</body>
</html>
